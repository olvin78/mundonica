{% extends 'base.html' %}

{% load static %}
  {% block head %}


  <link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
  crossorigin=""
/>

  <style>

    #map {
      height: 75vh;
      width: 90vw;
    }

    
  </style>
   {% endblock %}


{% block content %}
  <main class="main">
      <!-- Page Title -->
      <div class="page-title" data-aos="fade" style="background-image: url(assets/img/page-title-bg.webp); background-color: rgb(75, 112, 108);">
        <div class="container position-relative">
  
          <h1>Mapa</h1>
          <p>¡Haz zoom y explora! Nuestro mapa te lleva a los mejores negocios de Nicaragua.</p>

          <!-- <nav class="breadcrumbs">
            <ol>
              <li><a href="index.html">Home</a></li>
              <li class="current">Starter Page</li>
            </ol>
          </nav>-->
        </div>
      </div><!-- End Page Title -->
  
    <!--inicio del div para los mapas-->
    <section>
<!-- Contenedor principal -->
      <div class="container" id="map"></div>
  </section>
     <!--fin del div para los mapas-->
  </main>
  {% endblock %}

  {% block mapa %}
    <!-- Leaflet -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

<script>

//iconos en el mapa


    var consuladoIcon = L.icon({
        iconUrl: "{% static 'images/maps/iconos/consulado.png' %}",
        iconSize: [50, 50],
        iconAnchor: [25, 50],
        popupAnchor: [0, -50]
    });

    var embajadaIcon = L.icon({
        iconUrl: "{% static 'images/maps/iconos/embajada.png' %}",
        iconSize: [50, 50],
        iconAnchor: [25, 50],
        popupAnchor: [0, -50]
    });

    var restauranteIcon = L.icon({
        iconUrl: "{% static 'images/maps/iconos/restaurante.png' %}",
        iconSize: [50, 50],
        iconAnchor: [25, 50],
        popupAnchor: [0, -50]
    });

    var comercioIcon = L.icon({
        iconUrl: "{% static 'images/maps/iconos/tienda.png' %}",
        iconSize: [50, 50],
        iconAnchor: [25, 50],
        popupAnchor: [0, -50]
    });

///*fin de iconos en el mapa


const embajadas = L.layerGroup([
  {% for embajada in embajadas %}
    L.marker([{{ embajada.latitud }}, {{ embajada.longitud }}], {icon: embajadaIcon}) // Agrega el ícono
      .bindPopup(`<strong>{{ embajada.nombre }}</strong> 
      <br> {{ embajada.pais}}<br>  
      <img class='w-100' src='/media/{{ embajada.imagen }}'>
     <div class="text-center mt-2 w-100"><a href="#"><button class='btn btn-sm bg-success text-white'>Detalles</button></a></div>`), // Popup para cada marcador
  {% endfor %}

]);

const consulados = L.layerGroup([
  {% for consulado in consulados %}
    L.marker([{{ consulado.latitud }}, {{ consulado.longitud }}], {icon: consuladoIcon}) // Agrega el ícono
      .bindPopup(`<strong>{{ consulado.nombre }}</strong> 
      <br> {{ consulado.pais }}<br>  
      <img class='w-100' src='/media/{{ consulado.imagen }}'>
     <div class="text-center mt-2 w-100"><a href="#"><button class='btn btn-sm bg-success text-white'>Detalles</button></a></div>`), // Popup para cada marcador
  {% endfor %}
]);

const comercios = L.layerGroup([
  {% for comercio in comercios %}
    L.marker([{{ comercio.latitud }}, {{ comercio.longitud }}], {icon: comercioIcon}) // Agrega el ícono
      .bindPopup(`<strong>{{ comercio.nombre }}</strong> 
      <br> {{ comercio.pais}}<br>  
      <img class='w-100' src='/media/{{ comercio.imagen}}'>
     <div class="text-center mt-2 w-100"><a href="{% url 'home_app:empresa_detalle' comercio.nombreUrl %}"><button class='btn btn-sm bg-success text-white'>Detalles</button></a></div>`), // Popup para cada marcador
  {% endfor %}
]);

const restaurantes = L.layerGroup([
  {% for restaurante in restaurantes %}
    L.marker([{{ restaurante.latitud }}, {{ restaurante.longitud }}], {icon: restauranteIcon}) // Agrega el ícono
      .bindPopup(`<strong>{{ restaurante.nombre }}</strong> 
      <br> {{ restaurante.pais}}<br>  
      <img class='w-100' src='/media/{{ restaurante.imagen }}'>
     <div class="text-center mt-2 w-100"><a href="{% url 'home_app:empresa_detalle' restaurante.nombreUrl %}"><button class='btn btn-sm bg-success text-white'>Detalles</button></a></div>`), // Popup para cada marcador
  {% endfor %}
]);



// Capas base (mapas de fondo)
var osm = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19,
});

var osmHOT = L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
  maxZoom: 19,
  attribution: '© OpenStreetMap contributors, Tiles style by Humanitarian OpenStreetMap Team hosted by OpenStreetMap France'
});

var openTopoMap = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
  maxZoom: 19,
});

// Configuración del mapa
var map = L.map('map').setView([40.459391311992704, -3.65254964179598], 3);
    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: ''
    }).addTo(map);


// Configuración de capas base y superposiciones
var baseMaps = {
  "OpenStreetMap": osm,
  "OpenStreetMap.HOT": osmHOT,
  "OpenTopoMap": openTopoMap
};

var overlayMaps = {
  "Consulados": consulados,
  "Embajadas": embajadas,
  "Restaurantes": restaurantes,
  "Comercios": comercios
};

// Agregar el control de capas al mapa
L.control.layers(baseMaps, overlayMaps).addTo(map);

// Opcional: Mostrar ciertas capas por defecto
consulados.addTo(map);
embajadas.addTo(map);
restaurantes.addTo(map);
comercios.addTo(map);
</script>


  <!--fin del javascript de bootstrap para leaflet-->
{% endblock %}